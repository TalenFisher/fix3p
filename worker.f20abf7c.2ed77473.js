parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"Ofed":[function(require,module,exports) {
var define;
var r;function t(r){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(r){return typeof r}:function(r){return r&&"function"==typeof Symbol&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r})(r)}parcelRequire=function(e,n,s,o){var i,a="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function h(r,t){if(!n[r]){if(!e[r]){var s="function"==typeof parcelRequire&&parcelRequire;if(!t&&s)return s(r,!0);if(a)return a(r,!0);if(u&&"string"==typeof r)return u(r);var o=new Error("Cannot find module '"+r+"'");throw o.code="MODULE_NOT_FOUND",o}p.resolve=function(t){return e[r][1][t]||t},p.cache={};var i=n[r]=new h.Module(r);e[r][0].call(i.exports,p,i,i.exports,this)}return n[r].exports;function p(r){return h(p.resolve(r))}}h.isParcelRequire=!0,h.Module=function(r){this.id=r,this.bundle=h,this.exports={}},h.modules=e,h.cache=n,h.parent=a,h.register=function(r,t){e[r]=[function(r,e){e.exports=t},{}]};for(var p=0;p<s.length;p++)try{h(s[p])}catch(e){i||(i=e)}if(s.length){var c=h(s[s.length-1]);"object"==("undefined"==typeof exports?"undefined":t(exports))&&"undefined"!=typeof module?module.exports=c:"function"==typeof r&&r.amd?r(function(){return c}):this.X3P=c}if(parcelRequire=h,i)throw i;return h}({gm1b:[function(r,t,e){"use strict";e.__esModule=!0,e.default=function(r){return void 0===r&&(r=1),[[0,0],[0,r],[r,0],[r,r],[r,0],[0,r]]}},{}],oQJj:[function(r,t,e){t.exports=function(r){switch(r.toLowerCase()){case"int8":return Int8Array;case"i":case"int16":return Int16Array;case"l":case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"f":case"float32":return Float32Array;case"d":case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],YG3F:[function(r,t,e){"use strict";t.exports=function(r){for(var t=new Array(r),e=0;e<r;++e)t[e]=e;return t}},{}],"q/Zl":[function(r,t,e){function n(r){return!!r.constructor&&"function"==typeof r.constructor.isBuffer&&r.constructor.isBuffer(r)}t.exports=function(r){return null!=r&&(n(r)||function(r){return"function"==typeof r.readFloatLE&&"function"==typeof r.slice&&n(r.slice(0,0))}(r)||!!r._isBuffer)}},{}],cMKA:[function(r,t,e){var n=r("iota-array"),s=r("is-buffer"),o="undefined"!=typeof Float64Array;function i(r,t){return r[0]-t[0]}function a(){var r,t=this.stride,e=new Array(t.length);for(r=0;r<e.length;++r)e[r]=[Math.abs(t[r]),r];e.sort(i);var n=new Array(e.length);for(r=0;r<n.length;++r)n[r]=e[r][1];return n}function u(r,t){var e=["View",t,"d",r].join("");t<0&&(e="View_Nil"+r);var s="generic"===r;if(-1===t){var o="function "+e+"(a){this.data=a;};var proto="+e+".prototype;proto.dtype='"+r+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+e+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+e+"(a){return new "+e+"(a);}";return new Function(o)()}if(0===t)return o="function "+e+"(a,d) {this.data = a;this.offset = d};var proto="+e+".prototype;proto.dtype='"+r+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+e+"_copy() {return new "+e+"(this.data,this.offset)};proto.pick=function "+e+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+e+"_get(){return "+(s?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+e+"_set(v){return "+(s?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+e+"(a,b,c,d){return new "+e+"(a,d)}",new Function("TrivialArray",o)(p[r][0]);o=["'use strict'"];var i=n(t),u=i.map(function(r){return"i"+r}),h="this.offset+"+i.map(function(r){return"this.stride["+r+"]*i"+r}).join("+"),c=i.map(function(r){return"b"+r}).join(","),f=i.map(function(r){return"c"+r}).join(",");o.push("function "+e+"(a,"+c+","+f+",d){this.data=a","this.shape=["+c+"]","this.stride=["+f+"]","this.offset=d|0}","var proto="+e+".prototype","proto.dtype='"+r+"'","proto.dimension="+t),o.push("Object.defineProperty(proto,'size',{get:function "+e+"_size(){return "+i.map(function(r){return"this.shape["+r+"]"}).join("*"),"}})"),1===t?o.push("proto.order=[0]"):(o.push("Object.defineProperty(proto,'order',{get:"),t<4?(o.push("function "+e+"_order(){"),2===t?o.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):3===t&&o.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):o.push("ORDER})")),o.push("proto.set=function "+e+"_set("+u.join(",")+",v){"),s?o.push("return this.data.set("+h+",v)}"):o.push("return this.data["+h+"]=v}"),o.push("proto.get=function "+e+"_get("+u.join(",")+"){"),s?o.push("return this.data.get("+h+")}"):o.push("return this.data["+h+"]}"),o.push("proto.index=function "+e+"_index(",u.join(),"){return "+h+"}"),o.push("proto.hi=function "+e+"_hi("+u.join(",")+"){return new "+e+"(this.data,"+i.map(function(r){return["(typeof i",r,"!=='number'||i",r,"<0)?this.shape[",r,"]:i",r,"|0"].join("")}).join(",")+","+i.map(function(r){return"this.stride["+r+"]"}).join(",")+",this.offset)}");var l=i.map(function(r){return"a"+r+"=this.shape["+r+"]"}),d=i.map(function(r){return"c"+r+"=this.stride["+r+"]"});o.push("proto.lo=function "+e+"_lo("+u.join(",")+"){var b=this.offset,d=0,"+l.join(",")+","+d.join(","));for(var g=0;g<t;++g)o.push("if(typeof i"+g+"==='number'&&i"+g+">=0){d=i"+g+"|0;b+=c"+g+"*d;a"+g+"-=d}");for(o.push("return new "+e+"(this.data,"+i.map(function(r){return"a"+r}).join(",")+","+i.map(function(r){return"c"+r}).join(",")+",b)}"),o.push("proto.step=function "+e+"_step("+u.join(",")+"){var "+i.map(function(r){return"a"+r+"=this.shape["+r+"]"}).join(",")+","+i.map(function(r){return"b"+r+"=this.stride["+r+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil"),g=0;g<t;++g)o.push("if(typeof i"+g+"==='number'){d=i"+g+"|0;if(d<0){c+=b"+g+"*(a"+g+"-1);a"+g+"=ceil(-a"+g+"/d)}else{a"+g+"=ceil(a"+g+"/d)}b"+g+"*=d}");o.push("return new "+e+"(this.data,"+i.map(function(r){return"a"+r}).join(",")+","+i.map(function(r){return"b"+r}).join(",")+",c)}");var y=new Array(t),v=new Array(t);for(g=0;g<t;++g)y[g]="a[i"+g+"]",v[g]="b[i"+g+"]";for(o.push("proto.transpose=function "+e+"_transpose("+u+"){"+u.map(function(r,t){return r+"=("+r+"===undefined?"+t+":"+r+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+e+"(this.data,"+y.join(",")+","+v.join(",")+",this.offset)}"),o.push("proto.pick=function "+e+"_pick("+u+"){var a=[],b=[],c=this.offset"),g=0;g<t;++g)o.push("if(typeof i"+g+"==='number'&&i"+g+">=0){c=(c+this.stride["+g+"]*i"+g+")|0}else{a.push(this.shape["+g+"]);b.push(this.stride["+g+"])}");return o.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),o.push("return function construct_"+e+"(data,shape,stride,offset){return new "+e+"(data,"+i.map(function(r){return"shape["+r+"]"}).join(",")+","+i.map(function(r){return"stride["+r+"]"}).join(",")+",offset)}"),new Function("CTOR_LIST","ORDER",o.join("\n"))(p[r],a)}function h(r){if(s(r))return"buffer";if(o)switch(Object.prototype.toString.call(r)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped"}return Array.isArray(r)?"array":"generic"}var p={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],buffer:[],generic:[]};t.exports=function(r,t,e,n){if(void 0===r)return(0,p.array[0])([]);"number"==typeof r&&(r=[r]),void 0===t&&(t=[r.length]);var s=t.length;if(void 0===e){e=new Array(s);for(var o=s-1,i=1;o>=0;--o)e[o]=i,i*=t[o]}if(void 0===n)for(n=0,o=0;o<s;++o)e[o]<0&&(n-=(t[o]-1)*e[o]);for(var a=h(r),c=p[a];c.length<=s+1;)c.push(u(a,c.length-1));return(0,c[s+1])(r,t,e,n)}},{"iota-array":"YG3F","is-buffer":"q/Zl"}],fDKz:[function(r,e,n){"use strict";e.exports=function(r,e){switch(void 0===e&&(e=0),t(r)){case"number":if(r>0)return function(r,t){var e,n;for(e=new Array(r),n=0;n<r;++n)e[n]=t;return e}(0|r,e);break;case"object":if("number"==typeof r.length)return function r(t,e,n){var s=0|t[n];if(s<=0)return[];var o,i=new Array(s);if(n===t.length-1)for(o=0;o<s;++o)i[o]=e;else for(o=0;o<s;++o)i[o]=r(t,e,n+1);return i}(r,e,0)}return[]}},{}],"a/V3":[function(r,t,e){"use strict";t.exports=function(r,t,e){return 0===r.length?r:t?(e||r.sort(t),function(r,t){for(var e=1,n=r.length,s=r[0],o=r[0],i=1;i<n;++i)if(o=s,t(s=r[i],o)){if(i===e){e++;continue}r[e++]=s}return r.length=e,r}(r,t)):(e||r.sort(),function(r){for(var t=1,e=r.length,n=r[0],s=r[0],o=1;o<e;++o,s=n)if(s=n,(n=r[o])!==s){if(o===t){t++;continue}r[t++]=n}return r.length=t,r}(r))}},{}],XMcq:[function(r,t,e){"use strict";var n=r("uniq");function s(r,t,e){var n,s,o=r.length,i=t.arrayArgs.length,a=t.indexArgs.length>0,u=[],h=[],p=0,c=0;for(n=0;n<o;++n)h.push(["i",n,"=0"].join(""));for(s=0;s<i;++s)for(n=0;n<o;++n)c=p,p=r[n],0===n?h.push(["d",s,"s",n,"=t",s,"p",p].join("")):h.push(["d",s,"s",n,"=(t",s,"p",p,"-s",c,"*t",s,"p",c,")"].join(""));for(h.length>0&&u.push("var "+h.join(",")),n=o-1;n>=0;--n)p=r[n],u.push(["for(i",n,"=0;i",n,"<s",p,";++i",n,"){"].join(""));for(u.push(e),n=0;n<o;++n){for(c=p,p=r[n],s=0;s<i;++s)u.push(["p",s,"+=d",s,"s",n].join(""));a&&(n>0&&u.push(["index[",c,"]-=s",c].join("")),u.push(["++index[",p,"]"].join(""))),u.push("}")}return u.join("\n")}function o(r,t,e){for(var n=r.body,s=[],o=[],i=0;i<r.args.length;++i){var a=r.args[i];if(!(a.count<=0)){var u=new RegExp(a.name,"g"),h="",p=t.arrayArgs.indexOf(i);switch(t.argTypes[i]){case"offset":var c=t.offsetArgIndex.indexOf(i);p=t.offsetArgs[c].array,h="+q"+c;case"array":h="p"+p+h;var f="l"+i,l="a"+p;if(0===t.arrayBlockIndices[p])1===a.count?"generic"===e[p]?a.lvalue?(s.push(["var ",f,"=",l,".get(",h,")"].join("")),n=n.replace(u,f),o.push([l,".set(",h,",",f,")"].join(""))):n=n.replace(u,[l,".get(",h,")"].join("")):n=n.replace(u,[l,"[",h,"]"].join("")):"generic"===e[p]?(s.push(["var ",f,"=",l,".get(",h,")"].join("")),n=n.replace(u,f),a.lvalue&&o.push([l,".set(",h,",",f,")"].join(""))):(s.push(["var ",f,"=",l,"[",h,"]"].join("")),n=n.replace(u,f),a.lvalue&&o.push([l,"[",h,"]=",f].join("")));else{for(var d=[a.name],g=[h],y=0;y<Math.abs(t.arrayBlockIndices[p]);y++)d.push("\\s*\\[([^\\]]+)\\]"),g.push("$"+(y+1)+"*t"+p+"b"+y);if(u=new RegExp(d.join(""),"g"),h=g.join("+"),"generic"===e[p])throw new Error("cwise: Generic arrays not supported in combination with blocks!");n=n.replace(u,[l,"[",h,"]"].join(""))}break;case"scalar":n=n.replace(u,"Y"+t.scalarArgs.indexOf(i));break;case"index":n=n.replace(u,"index");break;case"shape":n=n.replace(u,"shape")}}}return[s.join("\n"),n,o.join("\n")].join("\n").trim()}function i(r){for(var t=new Array(r.length),e=!0,n=0;n<r.length;++n){var s=r[n],o=s.match(/\d+/);o=o?o[0]:"",0===s.charAt(0)?t[n]="u"+s.charAt(1)+o:t[n]=s.charAt(0)+o,n>0&&(e=e&&t[n]===t[n-1])}return e?t[0]:t.join("")}t.exports=function(r,t){for(var e=t[1].length-Math.abs(r.arrayBlockIndices[0])|0,a=new Array(r.arrayArgs.length),u=new Array(r.arrayArgs.length),h=0;h<r.arrayArgs.length;++h)u[h]=t[2*h],a[h]=t[2*h+1];var p=[],c=[],f=[],l=[],d=[];for(h=0;h<r.arrayArgs.length;++h){r.arrayBlockIndices[h]<0?(f.push(0),l.push(e),p.push(e),c.push(e+r.arrayBlockIndices[h])):(f.push(r.arrayBlockIndices[h]),l.push(r.arrayBlockIndices[h]+e),p.push(0),c.push(r.arrayBlockIndices[h]));for(var g=[],y=0;y<a[h].length;y++)f[h]<=a[h][y]&&a[h][y]<l[h]&&g.push(a[h][y]-f[h]);d.push(g)}var v=["SS"],j=["'use strict'"],b=[];for(y=0;y<e;++y)b.push(["s",y,"=SS[",y,"]"].join(""));for(h=0;h<r.arrayArgs.length;++h){for(v.push("a"+h),v.push("t"+h),v.push("p"+h),y=0;y<e;++y)b.push(["t",h,"p",y,"=t",h,"[",f[h]+y,"]"].join(""));for(y=0;y<Math.abs(r.arrayBlockIndices[h]);++y)b.push(["t",h,"b",y,"=t",h,"[",p[h]+y,"]"].join(""))}for(h=0;h<r.scalarArgs.length;++h)v.push("Y"+h);if(r.shapeArgs.length>0&&b.push("shape=SS.slice(0)"),r.indexArgs.length>0){var m=new Array(e);for(h=0;h<e;++h)m[h]="0";b.push(["index=[",m.join(","),"]"].join(""))}for(h=0;h<r.offsetArgs.length;++h){var w=r.offsetArgs[h],A=[];for(y=0;y<w.offset.length;++y)0!==w.offset[y]&&(1===w.offset[y]?A.push(["t",w.array,"p",y].join("")):A.push([w.offset[y],"*t",w.array,"p",y].join("")));0===A.length?b.push("q"+h+"=0"):b.push(["q",h,"=",A.join("+")].join(""))}var x=n([].concat(r.pre.thisVars).concat(r.body.thisVars).concat(r.post.thisVars));for((b=b.concat(x)).length>0&&j.push("var "+b.join(",")),h=0;h<r.arrayArgs.length;++h)j.push("p"+h+"|=0");r.pre.body.length>3&&j.push(o(r.pre,r,u));var k=o(r.body,r,u),M=function(r){for(var t=0,e=r[0].length;t<e;){for(var n=1;n<r.length;++n)if(r[n][t]!==r[0][t])return t;++t}return t}(d);M<e?j.push(function(r,t,e,n){for(var o=t.length,i=e.arrayArgs.length,a=e.blockSize,u=e.indexArgs.length>0,h=[],p=0;p<i;++p)h.push(["var offset",p,"=p",p].join(""));for(p=r;p<o;++p)h.push(["for(var j"+p+"=SS[",t[p],"]|0;j",p,">0;){"].join("")),h.push(["if(j",p,"<",a,"){"].join("")),h.push(["s",t[p],"=j",p].join("")),h.push(["j",p,"=0"].join("")),h.push(["}else{s",t[p],"=",a].join("")),h.push(["j",p,"-=",a,"}"].join("")),u&&h.push(["index[",t[p],"]=j",p].join(""));for(p=0;p<i;++p){for(var c=["offset"+p],f=r;f<o;++f)c.push(["j",f,"*t",p,"p",t[f]].join(""));h.push(["p",p,"=(",c.join("+"),")"].join(""))}for(h.push(s(t,e,n)),p=r;p<o;++p)h.push("}");return h.join("\n")}(M,d[0],r,k)):j.push(s(d[0],r,k)),r.post.body.length>3&&j.push(o(r.post,r,u)),r.debug&&console.log("-----Generated cwise routine for ",t,":\n"+j.join("\n")+"\n----------");var I=[r.funcName||"unnamed","_cwise_loop_",a[0].join("s"),"m",M,i(u)].join("");return new Function(["function ",I,"(",v.join(","),"){",j.join("\n"),"} return ",I].join(""))()}},{uniq:"a/V3"}],PgdI:[function(r,t,e){"use strict";var n=r("./compile.js");t.exports=function(r){var t=["'use strict'","var CACHED={}"],e=[],s=r.funcName+"_cwise_thunk";t.push(["return function ",s,"(",r.shimArgs.join(","),"){"].join(""));for(var o=[],i=[],a=[["array",r.arrayArgs[0],".shape.slice(",Math.max(0,r.arrayBlockIndices[0]),r.arrayBlockIndices[0]<0?","+r.arrayBlockIndices[0]+")":")"].join("")],u=[],h=[],p=0;p<r.arrayArgs.length;++p){var c=r.arrayArgs[p];e.push(["t",c,"=array",c,".dtype,","r",c,"=array",c,".order"].join("")),o.push("t"+c),o.push("r"+c),i.push("t"+c),i.push("r"+c+".join()"),a.push("array"+c+".data"),a.push("array"+c+".stride"),a.push("array"+c+".offset|0"),p>0&&(u.push("array"+r.arrayArgs[0]+".shape.length===array"+c+".shape.length+"+(Math.abs(r.arrayBlockIndices[0])-Math.abs(r.arrayBlockIndices[p]))),h.push("array"+r.arrayArgs[0]+".shape[shapeIndex+"+Math.max(0,r.arrayBlockIndices[0])+"]===array"+c+".shape[shapeIndex+"+Math.max(0,r.arrayBlockIndices[p])+"]"))}for(r.arrayArgs.length>1&&(t.push("if (!("+u.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same dimensionality!')"),t.push("for(var shapeIndex=array"+r.arrayArgs[0]+".shape.length-"+Math.abs(r.arrayBlockIndices[0])+"; shapeIndex--\x3e0;) {"),t.push("if (!("+h.join(" && ")+")) throw new Error('cwise: Arrays do not all have the same shape!')"),t.push("}")),p=0;p<r.scalarArgs.length;++p)a.push("scalar"+r.scalarArgs[p]);return e.push(["type=[",i.join(","),"].join()"].join("")),e.push("proc=CACHED[type]"),t.push("var "+e.join(",")),t.push(["if(!proc){","CACHED[type]=proc=compile([",o.join(","),"])}","return proc(",a.join(","),")}"].join("")),r.debug&&console.log("-----Generated thunk:\n"+t.join("\n")+"\n----------"),new Function("compile",t.join("\n"))(n.bind(void 0,r))}},{"./compile.js":"XMcq"}],"Kt/t":[function(r,e,n){"use strict";var s=r("./lib/thunk.js");function o(){this.argTypes=[],this.shimArgs=[],this.arrayArgs=[],this.arrayBlockIndices=[],this.scalarArgs=[],this.offsetArgs=[],this.offsetArgIndex=[],this.indexArgs=[],this.shapeArgs=[],this.funcName="",this.pre=null,this.body=null,this.post=null,this.debug=!1}e.exports=function(r){var e=new o;e.pre=r.pre,e.body=r.body,e.post=r.post;var n=r.args.slice(0);e.argTypes=n;for(var i=0;i<n.length;++i){var a=n[i];if("array"===a||"object"==t(a)&&a.blockIndices){if(e.argTypes[i]="array",e.arrayArgs.push(i),e.arrayBlockIndices.push(a.blockIndices?a.blockIndices:0),e.shimArgs.push("array"+i),i<e.pre.args.length&&e.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array args");if(i<e.post.args.length&&e.post.args[i].count>0)throw new Error("cwise: post() block may not reference array args")}else if("scalar"===a)e.scalarArgs.push(i),e.shimArgs.push("scalar"+i);else if("index"===a){if(e.indexArgs.push(i),i<e.pre.args.length&&e.pre.args[i].count>0)throw new Error("cwise: pre() block may not reference array index");if(i<e.body.args.length&&e.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array index");if(i<e.post.args.length&&e.post.args[i].count>0)throw new Error("cwise: post() block may not reference array index")}else if("shape"===a){if(e.shapeArgs.push(i),i<e.pre.args.length&&e.pre.args[i].lvalue)throw new Error("cwise: pre() block may not write to array shape");if(i<e.body.args.length&&e.body.args[i].lvalue)throw new Error("cwise: body() block may not write to array shape");if(i<e.post.args.length&&e.post.args[i].lvalue)throw new Error("cwise: post() block may not write to array shape")}else{if("object"!=t(a)||!a.offset)throw new Error("cwise: Unknown argument type "+n[i]);e.argTypes[i]="offset",e.offsetArgs.push({array:a.array,offset:a.offset}),e.offsetArgIndex.push(i)}}if(e.arrayArgs.length<=0)throw new Error("cwise: No array arguments specified");if(e.pre.args.length>n.length)throw new Error("cwise: Too many arguments in pre() block");if(e.body.args.length>n.length)throw new Error("cwise: Too many arguments in body() block");if(e.post.args.length>n.length)throw new Error("cwise: Too many arguments in post() block");return e.debug=!!r.printCode||!!r.debug,e.funcName=r.funcName||"cwise",e.blockSize=r.blockSize||64,s(e)}},{"./lib/thunk.js":"PgdI"}],AFCU:[function(r,t,e){"use strict";t.exports=function(r,t,e){if(Array.isArray(e)){if(e.length!==t.dimension)throw new Error("ndarray-gradient: invalid boundary conditions")}else e=n(t.dimension,"string"==typeof e?e:"clamp");if(r.dimension!==t.dimension+1)throw new Error("ndarray-gradient: output dimension must be +1 input dimension");if(r.shape[t.dimension]!==t.dimension)throw new Error("ndarray-gradient: output shape must match input shape");for(var s=0;s<t.dimension;++s)if(r.shape[s]!==t.shape[s])throw new Error("ndarray-gradient: shape mismatch");return 0===t.size?r:t.dimension<=0?(r.set(0),r):c(e)(r,t)};var n=r("dup"),s=r("cwise-compiler"),o={},i={},a={body:"",args:[],thisVars:[],localVars:[]},u=s({args:["array","array","array"],pre:a,post:a,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1},{name:"left",lvalue:!1,rvalue:!0,count:1},{name:"right",lvalue:!1,rvalue:!0,count:1}],body:"out=0.5*(left-right)",thisVars:[],localVars:[]},funcName:"cdiff"}),h=s({args:["array"],pre:a,post:a,body:{args:[{name:"out",lvalue:!0,rvalue:!1,count:1}],body:"out=0",thisVars:[],localVars:[]},funcName:"zero"});function p(r){if(r in o)return o[r];for(var t=[],e=0;e<r;++e)t.push("out",e,"s=0.5*(inp",e,"l-inp",e,"r);");var i=["array"],u=["junk"];for(e=0;e<r;++e){i.push("array"),u.push("out"+e+"s");var h=n(r);h[e]=-1,i.push({array:0,offset:h.slice()}),h[e]=1,i.push({array:0,offset:h.slice()}),u.push("inp"+e+"l","inp"+e+"r")}return o[r]=s({args:i,pre:a,post:a,body:{body:t.join(""),args:u.map(function(r){return{name:r,lvalue:0===r.indexOf("out"),rvalue:0===r.indexOf("inp"),count:"junk"!==r|0}}),thisVars:[],localVars:[]},funcName:"fdTemplate"+r})}function c(r){var t=r.join();if(v=i[t])return v;var e=r.length,n=["function gradient(dst,src){var s=src.shape.slice();"];function s(t){for(var s=e-t.length,o=[],i=[],a=[],u=0;u<e;++u)t.indexOf(u+1)>=0?a.push("0"):t.indexOf(-(u+1))>=0?a.push("s["+u+"]-1"):(a.push("-1"),o.push("1"),i.push("s["+u+"]-2"));var h=".lo("+o.join()+").hi("+i.join()+")";if(0===o.length&&(h=""),s>0){for(n.push("if(1"),u=0;u<e;++u)t.indexOf(u+1)>=0||t.indexOf(-(u+1))>=0||n.push("&&s[",u,"]>2");for(n.push("){grad",s,"(src.pick(",a.join(),")",h),u=0;u<e;++u)t.indexOf(u+1)>=0||t.indexOf(-(u+1))>=0||n.push(",dst.pick(",a.join(),",",u,")",h);n.push(");")}for(u=0;u<t.length;++u){var p=Math.abs(t[u])-1,c="dst.pick("+a.join()+","+p+")"+h;switch(r[p]){case"clamp":var f=a.slice(),l=a.slice();t[u]<0?f[p]="s["+p+"]-2":l[p]="1",0===s?n.push("if(s[",p,"]>1){dst.set(",a.join(),",",p,",0.5*(src.get(",f.join(),")-src.get(",l.join(),")))}else{dst.set(",a.join(),",",p,",0)};"):n.push("if(s[",p,"]>1){diff(",c,",src.pick(",f.join(),")",h,",src.pick(",l.join(),")",h,");}else{zero(",c,");};");break;case"mirror":0===s?n.push("dst.set(",a.join(),",",p,",0);"):n.push("zero(",c,");");break;case"wrap":var d=a.slice(),g=a.slice();t[u]<0?(d[p]="s["+p+"]-2",g[p]="0"):(d[p]="s["+p+"]-1",g[p]="1"),0===s?n.push("if(s[",p,"]>2){dst.set(",a.join(),",",p,",0.5*(src.get(",d.join(),")-src.get(",g.join(),")))}else{dst.set(",a.join(),",",p,",0)};"):n.push("if(s[",p,"]>2){diff(",c,",src.pick(",d.join(),")",h,",src.pick(",g.join(),")",h,");}else{zero(",c,");};");break;default:throw new Error("ndarray-gradient: Invalid boundary condition")}}s>0&&n.push("};")}for(var a=0;a<1<<e;++a){for(var c=[],f=0;f<e;++f)a&1<<f&&c.push(f+1);for(var l=0;l<1<<c.length;++l){var d=c.slice();for(f=0;f<c.length;++f)l&1<<f&&(d[f]=-d[f]);s(d)}}n.push("return dst;};return gradient");var g=["diff","zero"],y=[u,h];for(a=1;a<=e;++a)g.push("grad"+a),y.push(p(a));g.push(n.join(""));var v=Function.apply(void 0,g).apply(void 0,y);return o[t]=v,v}},{dup:"fDKz","cwise-compiler":"Kt/t"}],"R/2G":[function(r,t,e){"use strict";var n=this&&this.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};e.__esModule=!0;var s=n(r("./quad")),o=n(r("@talenfisher/dtype")),i=n(r("ndarray")),a=n(r("ndarray-gradient")),u=1e-4,h=5,p=function(){function r(r){this.vertexCount=0,this.elementCount=0,this.axes=[],this.lo=[1/0,1/0,1/0],this.hi=[-1/0,-1/0,-1/0],this.pointBuffer=r.pointBuffer,this.origin=r.origin,this.decimationFactor=r.decimationFactor||0,this.axes=[r.axes.x,r.axes.y,r.axes.z],this.shape=[this.axes[0].size,this.axes[1].size,3],this.dataLength=this.shape[0]*this.shape[1]*this.shape[2],this.coords=i.default(new Float32Array(this.dataLength),this.shape);var t=this.axes[2].dataType.name||"d",e=o.default(t);if(!e)throw new Error("Could not find data type '"+e+"'");var n=new e(this.pointBuffer),s=this.axes[0].increment/u,a=this.axes[1].increment/u,p=this.origin[1].toLowerCase(),c=this.origin[0].toLowerCase(),f="e"===p?0:this.shape[0],l="n"===c?0:this.shape[1];this.lo=[0,0,1/0],this.hi=[this.shape[0]*s,this.shape[1]*a,-1/0];for(var d=-1,g=0;g<n.length;g++){var y=g%this.shape[0],v=(0===y?++d:d)%this.shape[1],j=Math.abs(f-y)*s,b=Math.abs(l-v)*a,m=n[g]/u*h;this.coords.set(y,v,0,j),this.coords.set(y,v,1,b),this.coords.set(y,v,2,m),!isNaN(n[g])&&isFinite(n[g])&&(this.lo[2]=Math.min(this.lo[2],n[g]),this.hi[2]=Math.max(this.hi[2],n[g]))}this.buffer()}return r.prototype.setupGradient=function(){var r=[3,this.shape[0],this.shape[1],2],t=this.coords;this.gradient=i.default(new Float32Array(2*this.dataLength),r);for(var e=0;e<3;e++)a.default(this.gradient.pick(e),t.pick(null,null,e))},r.prototype.getNormal=function(r,t){if(this.gradient){var e=this.gradient.get(0,r,t,0),n=this.gradient.get(0,r,t,1),s=this.gradient.get(1,r,t,0),o=this.gradient.get(1,r,t,1),i=this.gradient.get(2,r,t,0),a=this.gradient.get(2,r,t,1),u=s*a-o*i,h=i*n-a*e,p=e*o-n*s,c=Math.sqrt(Math.pow(u,2)+Math.pow(h,2)+Math.pow(p,2));return c<1e-8?(c=Math.max(Math.abs(u),Math.abs(h),Math.abs(p)))<1e-8?(p=1,h=u=0,c=1):c=1/c:c=1/Math.sqrt(c),[u*c,h*c,p*c]}},r.prototype.buffer=function(){var r=this.stride,t=this.coords,e=s.default(r),n=0,o=this.shape[0]-r,i=this.shape[1]-r,a=e.length,u=o*i*a*8;this.setupGradient(),this.elementCount=0,this.vertexCount=0,this.coordBuffer=new Float32Array(u);for(var h=0;h<o;h+=r){r:for(var p=0;p<i;p+=r){for(var c=0;c<=r;c++)for(var f=0;f<=r;f++){var l=t.get(1+h+c,1+p+f,2);if(isNaN(l)||!isFinite(l))continue r}for(var d=h/this.shape[0],g=p/this.shape[1],y=0;y<a;y++){var v=h+e[y][0],j=p+e[y][1];this.coordBuffer[n++]=t.get(v,j,0),this.coordBuffer[n++]=t.get(v,j,1),this.coordBuffer[n++]=t.get(v,j,2);var b=this.getNormal(v,j);this.coordBuffer[n++]=b[0],this.coordBuffer[n++]=b[1],this.coordBuffer[n++]=b[2],this.coordBuffer[n++]=d,this.coordBuffer[n++]=g,this.vertexCount++}}postMessage({progress:h/this.shape[0]})}this.elementCount=n},Object.defineProperty(r.prototype,"result",{get:function(){var r=this.coords;return{vertexCount:this.vertexCount,elementCount:this.elementCount,buffer:this.coordBuffer,shape:[r.shape[0],r.shape[1]],bounds:[this.lo,this.hi]}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"stride",{get:function(){var r=this.decimationFactor;r=Math.max(0,r),r=Math.min(r,1);var t=this.coords.shape,e=(t[0]+t[1])/2,n=Math.floor(e/200);return 1+Math.floor(r*n)},enumerable:!0,configurable:!0}),r}();onmessage=function(r){var t=new p(r.data).result,e=Object.assign({progress:1},t),n=[t.buffer.buffer];postMessage(e,n),close()}},{"./quad":"gm1b","@talenfisher/dtype":"oQJj",ndarray:"cMKA","ndarray-gradient":"AFCU"}]},{},["R/2G"]);
},{}]},{},["Ofed"], null)